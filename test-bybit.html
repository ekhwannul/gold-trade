<!DOCTYPE html>
<html>
<head>
    <title>Test Bybit API</title>
</head>
<body>
    <h1>Test Bybit API</h1>
    <button onclick="testBybit()">Test Bybit</button>
    <button onclick="testSpot()">Test Spot</button>
    <pre id="result"></pre>

    <script>
    async function testBybit() {
        const result = document.getElementById('result');
        result.textContent = 'Loading...';
        
        try {
            const end = Date.now();
            const start = end - (200 * 3600 * 1000);
            const url = `https://api.bybit.com/v5/market/kline?category=linear&symbol=XAUUSD&interval=60&start=${start}&end=${end}&limit=200`;
            
            console.log('URL:', url);
            
            const res = await fetch(url);
            const data = await res.json();
            
            result.textContent = JSON.stringify(data, null, 2);
            
            if (data.retCode === 0 && data.result && data.result.list) {
                const candles = data.result.list.reverse().map(item => ({
                    time: new Date(parseInt(item[0])).toISOString(),
                    open: parseFloat(item[1]),
                    high: parseFloat(item[2]),
                    low: parseFloat(item[3]),
                    close: parseFloat(item[4])
                }));
                
                console.log('Candles:', candles.length);
                console.log('Latest:', candles[candles.length - 1]);
            }
        } catch (error) {
            result.textContent = 'Error: ' + error.message;
            console.error(error);
        }
    }
    </script>
</body>
</html>
